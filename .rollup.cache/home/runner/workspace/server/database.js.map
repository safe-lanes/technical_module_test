{"version":3,"file":"database.js","sourceRoot":"","sources":["database.ts"],"names":[],"mappings":"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","sourcesContent":["import { drizzle } from 'drizzle-orm/mysql2';\nimport mysql from 'mysql2/promise';\nimport {\n  users,\n  components,\n  runningHoursAudit,\n  spares,\n  sparesHistory,\n  storesLedger,\n  changeRequest,\n  changeRequestAttachment,\n  changeRequestComment,\n  type User,\n  type InsertUser,\n  type Component,\n  type InsertComponent,\n  type RunningHoursAudit,\n  type InsertRunningHoursAudit,\n  type Spare,\n  type InsertSpare,\n  type SpareHistory,\n  type InsertSpareHistory,\n  type StoresLedger,\n  type InsertStoresLedger,\n  type ChangeRequest,\n  type InsertChangeRequest,\n  workOrders,\n  type WorkOrder,\n  type InsertWorkOrder,\n} from '@shared/schema';\nimport { desc, max } from 'drizzle-orm';\nimport { eq, sql } from 'drizzle-orm';\nimport { type IStorage } from './storage';\n\n// Console logging for database operations\nfunction logDbOperation(operation: string, data?: any) {\n  console.log(\n    `🔄 MySQL DB Operation: ${operation}`,\n    data ? `${JSON.stringify(data).slice(0, 100)}...` : ''\n  );\n}\n\nexport class DatabaseStorage implements IStorage {\n  private db: ReturnType<typeof drizzle>;\n  private pool: mysql.Pool;\n\n  constructor() {\n    // Use MySQL RDS environment variables\n    const host = process.env.MYSQL_HOST;\n    const database = process.env.MYSQL_DATABASE;\n    const user = process.env.MYSQL_USER;\n    const password = process.env.MYSQL_PASSWORD;\n    const port = parseInt(process.env.MYSQL_PORT || '3306');\n\n    if (!host || !database || !user || !password) {\n      throw new Error(\n        'MySQL environment variables are required (MYSQL_HOST, MYSQL_DATABASE, MYSQL_USER, MYSQL_PASSWORD)'\n      );\n    }\n\n    console.log(\n      '✅ Technical Module using MySQL RDS database for persistent storage'\n    );\n\n    // Create MySQL connection pool\n    this.pool = mysql.createPool({\n      host,\n      port,\n      user,\n      password,\n      database,\n      waitForConnections: true,\n      connectionLimit: 20,\n      queueLimit: 0,\n      acquireTimeout: 60000,\n      timeout: 60000,\n    });\n\n    // Create drizzle instance\n    this.db = drizzle(this.pool, {\n      schema: {\n        users,\n        components,\n        runningHoursAudit,\n        spares,\n        sparesHistory,\n        storesLedger,\n        changeRequest,\n        changeRequestAttachment,\n        changeRequestComment,\n        workOrders,\n      },\n      mode: 'default',\n    });\n  }\n\n  async close() {\n    await this.pool.end();\n  }\n\n  async healthCheck(): Promise<boolean> {\n    try {\n      const connection = await this.pool.getConnection();\n      await connection.execute('SELECT 1');\n      connection.release();\n      return true;\n    } catch (error) {\n      console.error('Database health check failed:', error);\n      return false;\n    }\n  }\n\n  // Basic user operations for authentication\n  async getUser(id: number): Promise<User | undefined> {\n    const [user] = await this.db.select().from(users).where(eq(users.id, id));\n    return user || undefined;\n  }\n\n  async getUserByUsername(username: string): Promise<User | undefined> {\n    const [user] = await this.db\n      .select()\n      .from(users)\n      .where(eq(users.username, username));\n    return user || undefined;\n  }\n\n  async createUser(insertUser: InsertUser): Promise<User> {\n    const result = await this.db.insert(users).values(insertUser);\n    const insertId = result.insertId;\n    const [user] = await this.db\n      .select()\n      .from(users)\n      .where(eq(users.id, insertId));\n    return user;\n  }\n\n  // Components\n  async getComponents(vesselId?: string): Promise<Component[]> {\n    logDbOperation('getComponents', { vesselId });\n    if (vesselId) {\n      return await this.db\n        .select()\n        .from(components)\n        .where(eq(components.vesselId, vesselId));\n    }\n    return await this.db.select().from(components);\n  }\n\n  async getComponent(id: string): Promise<Component | undefined> {\n    const [component] = await this.db\n      .select()\n      .from(components)\n      .where(eq(components.id, id));\n    return component || undefined;\n  }\n\n  async createComponent(insertComponent: InsertComponent): Promise<Component> {\n    await this.db.insert(components).values(insertComponent);\n    const [component] = await this.db\n      .select()\n      .from(components)\n      .where(eq(components.id, insertComponent.id));\n    return component;\n  }\n\n  async updateComponent(\n    id: string,\n    updates: Partial<InsertComponent>\n  ): Promise<Component> {\n    await this.db.update(components).set(updates).where(eq(components.id, id));\n    const [component] = await this.db\n      .select()\n      .from(components)\n      .where(eq(components.id, id));\n    return component;\n  }\n\n  async deleteComponent(id: string): Promise<void> {\n    await this.db.delete(components).where(eq(components.id, id));\n  }\n\n  // Running Hours\n  async getRunningHoursAudit(): Promise<RunningHoursAudit[]> {\n    return await this.db.select().from(runningHoursAudit);\n  }\n\n  async getRunningHoursAudits(\n    componentId: string,\n    limit?: number\n  ): Promise<RunningHoursAudit[]> {\n    let query = this.db\n      .select()\n      .from(runningHoursAudit)\n      .where(eq(runningHoursAudit.componentId, componentId));\n    if (limit) {\n      query = query.limit(limit);\n    }\n    return await query;\n  }\n\n  async getRunningHoursAuditsInDateRange(\n    componentId: string,\n    startDate: Date,\n    endDate: Date\n  ): Promise<RunningHoursAudit[]> {\n    return await this.db\n      .select()\n      .from(runningHoursAudit)\n      .where(eq(runningHoursAudit.componentId, componentId))\n      .where(sql`${runningHoursAudit.enteredAtUTC} >= ${startDate}`)\n      .where(sql`${runningHoursAudit.enteredAtUTC} <= ${endDate}`);\n  }\n\n  async createRunningHoursAudit(\n    insertAudit: InsertRunningHoursAudit\n  ): Promise<RunningHoursAudit> {\n    const result = await this.db.insert(runningHoursAudit).values(insertAudit);\n    const insertId = result.insertId;\n    const [audit] = await this.db\n      .select()\n      .from(runningHoursAudit)\n      .where(eq(runningHoursAudit.id, insertId));\n    return audit;\n  }\n\n  // Spares\n  async getSpares(vesselId?: string): Promise<Spare[]> {\n    logDbOperation('getSpares', { vesselId });\n    if (vesselId) {\n      return await this.db\n        .select()\n        .from(spares)\n        .where(eq(spares.vesselId, vesselId));\n    }\n    return await this.db.select().from(spares);\n  }\n\n  async getSpare(id: number): Promise<Spare | undefined> {\n    const [spare] = await this.db\n      .select()\n      .from(spares)\n      .where(eq(spares.id, id));\n    return spare || undefined;\n  }\n\n  async createSpare(insertSpare: InsertSpare): Promise<Spare> {\n    logDbOperation('createSpare', insertSpare);\n    const result = await this.db.insert(spares).values(insertSpare);\n    const insertId = result.insertId;\n    const [spare] = await this.db\n      .select()\n      .from(spares)\n      .where(eq(spares.id, insertId));\n    return spare;\n  }\n\n  async updateSpare(id: number, updates: Partial<InsertSpare>): Promise<Spare> {\n    logDbOperation('updateSpare', { id, updates });\n    await this.db.update(spares).set(updates).where(eq(spares.id, id));\n    const [spare] = await this.db\n      .select()\n      .from(spares)\n      .where(eq(spares.id, id));\n    return spare;\n  }\n\n  async deleteSpare(id: number): Promise<void> {\n    await this.db.delete(spares).where(eq(spares.id, id));\n  }\n\n  // Spares History\n  async getSparesHistory(): Promise<SpareHistory[]> {\n    return await this.db.select().from(sparesHistory);\n  }\n\n  async createSpareHistory(\n    insertHistory: InsertSpareHistory\n  ): Promise<SpareHistory> {\n    const result = await this.db.insert(sparesHistory).values(insertHistory);\n    const insertId = result.insertId;\n    const [history] = await this.db\n      .select()\n      .from(sparesHistory)\n      .where(eq(sparesHistory.id, insertId));\n    return history;\n  }\n\n  // Stores Ledger\n  async getStoresLedger(): Promise<StoresLedger[]> {\n    return await this.db.select().from(storesLedger);\n  }\n\n  async createStoresLedgerEntry(\n    insertLedger: InsertStoresLedger\n  ): Promise<StoresLedger> {\n    const result = await this.db.insert(storesLedger).values(insertLedger);\n    const insertId = result.insertId;\n    const [ledger] = await this.db\n      .select()\n      .from(storesLedger)\n      .where(eq(storesLedger.id, insertId));\n    return ledger;\n  }\n\n  // Change Requests - using filtered version below\n\n  async getChangeRequest(id: number): Promise<ChangeRequest | undefined> {\n    const [cr] = await this.db\n      .select()\n      .from(changeRequest)\n      .where(eq(changeRequest.id, id));\n    return cr || undefined;\n  }\n\n  async createChangeRequest(\n    insertCR: InsertChangeRequest\n  ): Promise<ChangeRequest> {\n    const result = await this.db.insert(changeRequest).values(insertCR);\n    const insertId = result.insertId;\n    const [cr] = await this.db\n      .select()\n      .from(changeRequest)\n      .where(eq(changeRequest.id, insertId));\n    return cr;\n  }\n\n  async updateChangeRequest(\n    id: number,\n    updates: Partial<InsertChangeRequest>\n  ): Promise<ChangeRequest> {\n    await this.db\n      .update(changeRequest)\n      .set(updates)\n      .where(eq(changeRequest.id, id));\n    const [cr] = await this.db\n      .select()\n      .from(changeRequest)\n      .where(eq(changeRequest.id, id));\n    return cr;\n  }\n\n  async deleteChangeRequest(id: number): Promise<void> {\n    await this.db.delete(changeRequest).where(eq(changeRequest.id, id));\n  }\n\n  // Additional methods required by IStorage\n  async consumeSpare(\n    id: number,\n    quantity: number,\n    userId: string,\n    remarks?: string,\n    place?: string,\n    dateLocal?: string,\n    tz?: string\n  ): Promise<Spare> {\n    // Get current spare\n    const spare = await this.getSpare(id);\n    if (!spare) throw new Error('Spare not found');\n\n    // Update ROB\n    const newRob = spare.rob - quantity;\n    const updatedSpare = await this.updateSpare(id, { rob: newRob });\n\n    // Create history entry\n    await this.createSpareHistory({\n      timestampUTC: new Date(),\n      vesselId: spare.vesselId,\n      spareId: id,\n      partCode: spare.partCode,\n      partName: spare.partName,\n      componentId: spare.componentId,\n      componentCode: spare.componentCode,\n      componentName: spare.componentName,\n      componentSpareCode: spare.componentSpareCode,\n      eventType: 'CONSUME',\n      qtyChange: -quantity,\n      robAfter: newRob,\n      userId,\n      remarks: remarks || null,\n      reference: null,\n      dateLocal: dateLocal || null,\n      tz: tz || null,\n      place: place || null,\n    });\n\n    return updatedSpare;\n  }\n\n  async receiveSpare(\n    id: number,\n    quantity: number,\n    userId: string,\n    remarks?: string,\n    supplierPO?: string,\n    place?: string,\n    dateLocal?: string,\n    tz?: string\n  ): Promise<Spare> {\n    // Get current spare\n    const spare = await this.getSpare(id);\n    if (!spare) throw new Error('Spare not found');\n\n    // Update ROB\n    const newRob = spare.rob + quantity;\n    const updatedSpare = await this.updateSpare(id, { rob: newRob });\n\n    // Create history entry\n    await this.createSpareHistory({\n      timestampUTC: new Date(),\n      vesselId: spare.vesselId,\n      spareId: id,\n      partCode: spare.partCode,\n      partName: spare.partName,\n      componentId: spare.componentId,\n      componentCode: spare.componentCode,\n      componentName: spare.componentName,\n      componentSpareCode: spare.componentSpareCode,\n      eventType: 'RECEIVE',\n      qtyChange: quantity,\n      robAfter: newRob,\n      userId,\n      remarks: remarks || null,\n      reference: supplierPO || null,\n      dateLocal: dateLocal || null,\n      tz: tz || null,\n      place: place || null,\n    });\n\n    return updatedSpare;\n  }\n\n  async bulkUpdateSpares(\n    updates: Array<{\n      id: number;\n      consumed?: number;\n      received?: number;\n      receivedDate?: string;\n      receivedPlace?: string;\n    }>,\n    userId: string,\n    remarks?: string\n  ): Promise<Spare[]> {\n    const results: Spare[] = [];\n\n    for (const update of updates) {\n      if (update.consumed) {\n        const result = await this.consumeSpare(\n          update.id,\n          update.consumed,\n          userId,\n          remarks\n        );\n        results.push(result);\n      }\n\n      if (update.received) {\n        const result = await this.receiveSpare(\n          update.id,\n          update.received,\n          userId,\n          remarks,\n          undefined,\n          update.receivedPlace,\n          update.receivedDate\n        );\n        results.push(result);\n      }\n    }\n\n    return results;\n  }\n\n  async getSpareHistory(vesselId: string): Promise<SpareHistory[]> {\n    return await this.db\n      .select()\n      .from(sparesHistory)\n      .where(eq(sparesHistory.vesselId, vesselId));\n  }\n\n  async getSpareHistoryBySpareId(spareId: number): Promise<SpareHistory[]> {\n    return await this.db\n      .select()\n      .from(sparesHistory)\n      .where(eq(sparesHistory.spareId, spareId));\n  }\n\n  // Store Ledger methods\n  async getStoreItems(vesselId: string): Promise<any[]> {\n    logDbOperation('getStoreItems', { vesselId });\n\n    try {\n      // Get all transactions for this vessel\n      const allTransactions = await this.db\n        .select()\n        .from(storesLedger)\n        .where(eq(storesLedger.vesselId, vesselId))\n        .orderBy(desc(storesLedger.timestampUTC));\n\n      // Group by item code to get latest info\n      const itemsMap = new Map();\n\n      for (const transaction of allTransactions) {\n        const itemCode = transaction.itemCode;\n\n        if (!itemsMap.has(itemCode)) {\n          // Initialize with basic info\n          itemsMap.set(itemCode, {\n            item_code: transaction.itemCode,\n            item_name: transaction.itemName,\n            uom: transaction.unit,\n            rob: parseFloat(transaction.robAfter.toString()),\n            min_stock: 1, // Default\n            location: transaction.place || 'Store Room',\n            category: 'stores',\n            notes: '',\n          });\n        }\n\n        // Update with latest catalog info if this is a CATALOG_UPDATE\n        if (transaction.eventType === 'CATALOG_UPDATE' && transaction.remarks) {\n          try {\n            const catalogInfo = JSON.parse(transaction.remarks);\n            const item = itemsMap.get(itemCode);\n            item.min_stock = catalogInfo.minStock || 1;\n            item.notes = catalogInfo.notes || '';\n            item.location = catalogInfo.location || item.location;\n          } catch (e) {\n            // Ignore invalid JSON\n          }\n        }\n      }\n\n      // Convert map to array and calculate stock status\n      const result = Array.from(itemsMap.values()).map(item => ({\n        ...item,\n        stock:\n          item.rob <= item.min_stock\n            ? 'Minimum'\n            : item.rob <= item.min_stock * 1.5\n              ? 'Low'\n              : 'OK',\n      }));\n\n      return result;\n    } catch (error) {\n      console.error('Error fetching store items:', error);\n      return [];\n    }\n  }\n\n  async createStoreTransaction(transaction: any): Promise<any> {\n    logDbOperation('createStoreTransaction', transaction);\n    await this.db.insert(storesLedger).values(transaction);\n    return transaction; // MySQL doesn't support returning, so return the original transaction\n  }\n\n  async getStoreHistory(vesselId: string): Promise<any[]> {\n    logDbOperation('getStoreHistory', { vesselId });\n    return await this.db\n      .select()\n      .from(storesLedger)\n      .where(eq(storesLedger.vesselId, vesselId))\n      .orderBy(desc(storesLedger.timestampUTC));\n  }\n\n  async updateStoreItem(\n    vesselId: string,\n    itemCode: string,\n    updates: any\n  ): Promise<any> {\n    logDbOperation('updateStoreItem', { vesselId, itemCode, updates });\n\n    // Get current ROB for this item\n    const currentItems = await this.getStoreItems(vesselId);\n    const currentItem = currentItems.find(item => item.item_code === itemCode);\n\n    if (!currentItem) {\n      throw new Error('Store item not found');\n    }\n\n    // Store catalog info as JSON in remarks field until schema is updated\n    const catalogInfo = {\n      minStock: updates.minStock,\n      notes: updates.notes,\n      location: updates.location,\n      updatedAt: new Date().toISOString(),\n    };\n\n    // Create a new transaction with updated details\n    const editTransaction = {\n      vesselId,\n      itemCode,\n      itemName: updates.itemName,\n      unit: updates.uom,\n      eventType: 'CATALOG_UPDATE',\n      quantity: 0,\n      robAfter: currentItem.rob, // Keep same ROB\n      place: updates.location || '',\n      dateLocal: new Date().toISOString().split('T')[0],\n      tz: 'UTC',\n      timestampUTC: new Date(),\n      userId: 'system',\n      remarks: JSON.stringify(catalogInfo),\n    };\n\n    await this.db.insert(storesLedger).values(editTransaction);\n\n    // Force cache invalidation by adding a timestamp to response\n    return {\n      ...editTransaction,\n      success: true,\n      timestamp: new Date().getTime(),\n      updatedFields: updates,\n    };\n  }\n\n  // Placeholder implementations for remaining IStorage methods\n  async getChangeRequests(filters?: {\n    category?: string;\n    status?: string;\n    q?: string;\n    vesselId?: string;\n  }): Promise<ChangeRequest[]> {\n    let query = this.db.select().from(changeRequest);\n    if (filters?.vesselId) {\n      query = query.where(eq(changeRequest.vesselId, filters.vesselId));\n    }\n    if (filters?.status) {\n      query = query.where(eq(changeRequest.status, filters.status));\n    }\n    return await query;\n  }\n\n  // Stub methods - will implement as needed\n  async getChangeRequestAttachments(): Promise<any[]> {\n    return [];\n  }\n  async getChangeRequestComments(): Promise<any[]> {\n    return [];\n  }\n  async updateChangeRequestTarget(): Promise<any> {\n    throw new Error('Not implemented');\n  }\n  async updateChangeRequestProposed(): Promise<any> {\n    throw new Error('Not implemented');\n  }\n  async submitChangeRequest(): Promise<any> {\n    throw new Error('Not implemented');\n  }\n  async approveChangeRequest(): Promise<any> {\n    throw new Error('Not implemented');\n  }\n  async rejectChangeRequest(): Promise<any> {\n    throw new Error('Not implemented');\n  }\n  async returnChangeRequest(): Promise<any> {\n    throw new Error('Not implemented');\n  }\n  async createChangeRequestAttachment(): Promise<any> {\n    throw new Error('Not implemented');\n  }\n  async createChangeRequestComment(): Promise<any> {\n    throw new Error('Not implemented');\n  }\n\n  // Work Orders methods\n  async getWorkOrders(vesselId: string): Promise<WorkOrder[]> {\n    logDbOperation('getWorkOrders', { vesselId });\n\n    try {\n      return await this.db\n        .select()\n        .from(workOrders)\n        .where(eq(workOrders.vesselId, vesselId))\n        .orderBy(desc(workOrders.createdAt));\n    } catch (error) {\n      console.error('Failed to get work orders:', error);\n\n      // If table doesn't exist, create it and return empty array\n      if (error instanceof Error && error.message.includes(\"doesn't exist\")) {\n        logDbOperation('getWorkOrders - table not found, creating table', {});\n        await this.createWorkOrdersTable();\n        return [];\n      }\n\n      throw error;\n    }\n  }\n\n  private async createWorkOrdersTable(): Promise<void> {\n    try {\n      const connection = await this.pool.getConnection();\n      await connection.execute(`\n        CREATE TABLE IF NOT EXISTS work_orders (\n          id VARCHAR(100) PRIMARY KEY,\n          vessel_id VARCHAR(50) NOT NULL DEFAULT 'V001',\n          component VARCHAR(255) NOT NULL,\n          component_code VARCHAR(100),\n          work_order_no VARCHAR(50) NOT NULL,\n          template_code VARCHAR(100),\n          execution_id VARCHAR(100),\n          job_title VARCHAR(500) NOT NULL,\n          assigned_to VARCHAR(255) NOT NULL,\n          due_date VARCHAR(50) NOT NULL,\n          status VARCHAR(50) NOT NULL,\n          date_completed VARCHAR(50),\n          submitted_date VARCHAR(50),\n          form_data JSON,\n          task_type VARCHAR(100),\n          maintenance_basis VARCHAR(50),\n          frequency_value VARCHAR(50),\n          frequency_unit VARCHAR(50),\n          approver_remarks TEXT,\n          is_execution BOOLEAN DEFAULT FALSE,\n          template_id VARCHAR(100),\n          approver VARCHAR(255),\n          approval_date VARCHAR(50),\n          rejection_date VARCHAR(50),\n          next_due_date VARCHAR(50),\n          next_due_reading VARCHAR(50),\n          current_reading VARCHAR(50),\n          created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n          updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n          INDEX idx_wo_vessel (vessel_id),\n          INDEX idx_wo_status (status),\n          INDEX idx_wo_component (component_code),\n          INDEX idx_wo_due_date (due_date)\n        )\n      `);\n      connection.release();\n      console.log('✅ Created work_orders table in MySQL RDS');\n\n      console.log('✅ Work orders table ready for use');\n    } catch (error) {\n      console.error('❌ Failed to create work_orders table:', error);\n    }\n  }\n\n  private async seedWorkOrdersData(): Promise<void> {\n    try {\n      const sampleWorkOrder = {\n        id: 'test-wo',\n        vesselId: 'V001',\n        component: 'Main Engine',\n        componentCode: 'ME-001',\n        workOrderNo: 'WO-2025-001',\n        templateCode: 'WO-ME-001-INSM1',\n        jobTitle: 'Monthly Engine Inspection',\n        assignedTo: 'Chief Engineer',\n        dueDate: '2025-12-31',\n        status: 'Due',\n        taskType: 'Inspection',\n        maintenanceBasis: 'Calendar',\n        frequencyValue: '1',\n        frequencyUnit: 'Months',\n        formData: {\n          woTitle: 'Monthly Engine Inspection',\n          component: 'Main Engine',\n          componentCode: 'ME-001',\n        },\n      };\n\n      await this.createWorkOrder(sampleWorkOrder);\n      console.log('✅ Seeded sample work order data');\n    } catch (error) {\n      console.error('❌ Failed to seed work order data:', error);\n    }\n  }\n\n  async createWorkOrder(workOrderData: InsertWorkOrder): Promise<WorkOrder> {\n    logDbOperation('createWorkOrder', workOrderData);\n\n    try {\n      await this.db.insert(workOrders).values(workOrderData);\n\n      // MySQL doesn't support RETURNING, so we fetch the inserted record\n      const [newWorkOrder] = await this.db\n        .select()\n        .from(workOrders)\n        .where(eq(workOrders.id, workOrderData.id))\n        .limit(1);\n\n      return newWorkOrder;\n    } catch (error) {\n      console.error('Failed to create work order:', error);\n      throw error;\n    }\n  }\n\n  async updateWorkOrder(\n    workOrderId: string,\n    workOrderData: Partial<InsertWorkOrder>\n  ): Promise<WorkOrder> {\n    logDbOperation('updateWorkOrder', { workOrderId, ...workOrderData });\n\n    try {\n      await this.db\n        .update(workOrders)\n        .set(workOrderData)\n        .where(eq(workOrders.id, workOrderId));\n\n      // MySQL doesn't support RETURNING, so we fetch the updated record\n      const [updatedWorkOrder] = await this.db\n        .select()\n        .from(workOrders)\n        .where(eq(workOrders.id, workOrderId))\n        .limit(1);\n\n      return updatedWorkOrder;\n    } catch (error) {\n      console.error('Failed to update work order:', error);\n      throw error;\n    }\n  }\n\n  async deleteWorkOrder(workOrderId: string): Promise<void> {\n    logDbOperation('deleteWorkOrder', { workOrderId });\n\n    try {\n      await this.db.delete(workOrders).where(eq(workOrders.id, workOrderId));\n    } catch (error) {\n      console.error('Failed to delete work order:', error);\n      throw error;\n    }\n  }\n}\n\n// Export singleton instance\nexport const storage = new DatabaseStorage();\nconsole.log(\n  '✅ Technical Module using MySQL RDS database for persistent storage'\n);\n\n// Seed some test store data if tables are empty\n(async () => {\n  try {\n    // Check if we have any store data\n    const existingStores = await storage.getStoreItems('V001');\n    if (existingStores.length === 0) {\n      console.log('🌱 Seeding test store data into MySQL...');\n\n      // Add some initial store transactions\n      const sampleStoreTransactions = [\n        {\n          vesselId: 'V001',\n          itemCode: 'ST-TOOL-001',\n          itemName: 'Torque Wrench',\n          unit: 'pcs',\n          eventType: 'INITIAL',\n          quantity: 2,\n          robAfter: 2,\n          place: 'Store Room A',\n          dateLocal: '2025-09-03 05:00:00',\n          tz: 'UTC',\n          timestampUTC: new Date(),\n          userId: 'system',\n          remarks: 'Initial stock',\n        },\n        {\n          vesselId: 'V001',\n          itemCode: 'ST-CONS-001',\n          itemName: 'Cotton Rags',\n          unit: 'kg',\n          eventType: 'INITIAL',\n          quantity: 5,\n          robAfter: 5,\n          place: 'Store Room B',\n          dateLocal: '2025-09-03 05:00:00',\n          tz: 'UTC',\n          timestampUTC: new Date(),\n          userId: 'system',\n          remarks: 'Initial stock',\n        },\n        {\n          vesselId: 'V001',\n          itemCode: 'ST-SEAL-001',\n          itemName: 'O-Ring Set',\n          unit: 'set',\n          eventType: 'INITIAL',\n          quantity: 3,\n          robAfter: 3,\n          place: 'Store Room B',\n          dateLocal: '2025-09-03 05:00:00',\n          tz: 'UTC',\n          timestampUTC: new Date(),\n          userId: 'system',\n          remarks: 'Initial stock',\n        },\n      ];\n\n      for (const transaction of sampleStoreTransactions) {\n        await storage.createStoreTransaction(transaction);\n      }\n\n      console.log('✅ Test store data seeded successfully');\n    }\n  } catch (error) {\n    console.error('Error seeding store data:', error);\n  }\n})();\n"]}