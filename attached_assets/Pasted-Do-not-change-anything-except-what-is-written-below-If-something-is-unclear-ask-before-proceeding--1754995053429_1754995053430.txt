Do not change anything except what is written below. If something is unclear, ask before proceeding.
Modify PMS — Change Requests (Phase 1.1)
Goal (very important)

    Add a Target Picker overlay so a user can select the exact item (Component / Work Order / Spare / Store) their request is about.

    Store a read-only snapshot of the selected target with the request.

    Do NOT modify Components, Work Orders, Spares, Stores, or any PMS data. No apply/renumber. No diffs yet.

A) Minimal data additions

Update the existing change_request table (or model) to include:

    targetType enum: component | work_order | spare | store (nullable until user selects)

    targetId string (or numeric FK) (nullable until user selects)

    snapshotBeforeJson JSON (nullable)

    No other schema changes. Do not remove any existing fields.

B) New UI — Target Picker overlay

On the New Change Request modal/page:

    Keep current fields: Title, Category, Reason.

    Under Category, add a button: Select Target (disabled until Category is chosen).

    Clicking Select Target opens a full-screen overlay (modal) with the selector appropriate to the chosen category:

If Category = Components

    Left: Component tree (reuse the exact tree component from Components module; include search & expand/collapse).

    Right: Preview panel showing read-only details of the selected node:

        Header: Component name + code + full path (e.g., 6.1.1.2 Cylinder Liners).

        Section A fields (Maker, Model, Serial No, Dept/Category, Location, Commissioned Date, Critical, Class Item).

        (Do NOT allow edit; do NOT fetch or show Sections B–H yet.)

    Footer: Use this target (primary), Cancel.

    “Use this target” sets targetType='component', targetId=<componentId>, and persists the snapshot to snapshotBeforeJson.

If Category = Work Orders

    Show the Work Orders list (reuse table from WO sub-module: search, filters). Selecting a row opens a read-only preview on the right:

        WO No, Job Title, Component link, Frequency (type + value), Assigned To, Priority, Status.

    Footer: Use this target, Cancel → Save targetType='work_order', targetId, snapshotBeforeJson.

If Category = Spares

    Show the Spares Inventory list (reuse table; search, filters). Selecting a row shows read-only preview:

        Part Code, Part Name, Linked Component (if any), UOM, Min, ROB, Location, Critical.

    Footer → Save targetType='spare', targetId, snapshotBeforeJson.

If Category = Stores

    Show the Stores list (the “Stores” tab of Stores Inventory; search, filters). Selecting a row shows read-only preview:

        Item Code, Item Name, Stores Category, UOM, Min, ROB, Location.

    Footer → Save targetType='store', targetId, snapshotBeforeJson.

Snapshot contents
For consistency, store each snapshot with:

{
  "capturedAtUtc": "<ISO>",
  "vesselId": "<id>",
  "displayPath": "<for components>",
  "displayKey": "<WO No / Part Code / Item Code>",
  "displayName": "<title/name>",
  "fields": { ... key:value map of read-only fields shown in preview ... }
}

    Keep keys human and stable (e.g., maker, model, frequencyType, frequencyValue, uom, min, rob, location, etc.).

    Do not include large blobs (attachments); just the small fields we show.

C) Target summary card (after selection)

Back on the New Change Request form (and also on the Detail View):

    Render a compact Target card:

        Icon by type, Name, Code/WO No/Item Code, and Path (for components).

        A View snapshot link opens a small dialog showing the fields map in read-only table form.

        A Change link re-opens the Target Picker (replaces target + snapshot).

    Validation for Submit (vs Save Draft):

        Require Title, Category, Reason, Target (type + id + snapshot present).

D) API (new/updated)

    PUT /modify-pms/requests/:id/target
    Body: { targetType, targetId, snapshotBeforeJson }

        Valid only while status is draft or returned.

    GET /modify-pms/requests/:id must include the new fields.

Note: Where possible, derive snapshots using the same read services used by Components/WO/Spares/Stores pages to avoid business logic duplication.
E) Non-goals (guard rails)

    Do not compute diffs, renumber anything, or apply changes.

    Do not mutate any PMS entity.

    Do not show editable fields in preview.

    Keep all existing screens/flows untouched.

F) Acceptance checks (must pass)

    User selects Category → Select Target opens the correct overlay (tree/table reused from existing module).

    Selecting a target and clicking Use this target updates the request with targetType, targetId, and snapshotBeforeJson.

        The target summary card appears on the form.

    Submit is blocked unless Title, Category, Reason, and Target are set.

    Office Detail View shows the Target card and allows View snapshot (read-only).

    No other modules (Components, WO, Spares, Stores) change. No data applied/renumbered.